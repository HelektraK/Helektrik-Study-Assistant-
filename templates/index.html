{% extends "base.html" %}
{% block content %}

<h1>Helektrik Study Assistant</h1>
<p class="subtitle">
    Upload lecture materials (PDF, slides, audio, notes), then generate summaries, key terms, questions, and more.
</p>

<div class="layout">

    <!-- LEFT PANEL -->
    <div class="card">
        <h2>1. Upload Materials</h2>

        <div class="upload-box">
            <p><strong>Upload files:</strong> .txt, .pdf, .pptx, .mp4, .m4a, .wav, .webm</p>
            <p class="file-limits">Max file size: 50MB</p>

            <form
                hx-post="/upload"
                hx-target="#materials-panel"
                hx-swap="outerHTML"
                hx-indicator="#upload-loading"
                enctype="multipart/form-data">

                <input type="file" name="file" required accept=".txt,.pdf,.pptx,.mp4,.m4a,.wav,.webm">
                <input type="hidden" name="session_id" id="session_id_input">
                <br><br>
                <button class="primary" type="submit">Upload</button>
            </form>
        </div>

        <div class="upload-box">
            <p><strong>Live Transcription:</strong> record audio and transcribe with Whisper.</p>
            <button class="secondary" id="record-btn">ðŸŽ™ Start Recording</button>
            <p id="record-status" style="font-size: 12px; color:#555; margin-top:6px;"></p>
        </div>

        <div id="upload-loading" class="htmx-indicator">
            <div class="spinner"></div>
            <p>Uploading/processing...</p>
        </div>

        <div id="materials-panel">
            <em>No materials uploaded yet.</em>
        </div>

    </div>

    <!-- RIGHT PANEL -->
    <div class="card">
        <h2>2. Generate Study Material</h2>

        <p style="font-size:13px; color:#555;">Choose what you want the AI to generate (powered by RAG).</p>

        <div id="study-buttons" style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px;">
            <button class="study-btn" id="btn-summary" disabled hx-get="" hx-target="#results-panel" hx-indicator="#generate-loading">
                Summary
            </button>
            <button class="study-btn" id="btn-keyterms" disabled hx-get="" hx-target="#results-panel" hx-indicator="#generate-loading">
                Key Terms
            </button>
            <button class="study-btn" id="btn-questions" disabled hx-get="" hx-target="#results-panel" hx-indicator="#generate-loading">
                Practice Questions
            </button>
            <button class="study-btn" id="btn-resources" disabled hx-get="" hx-target="#results-panel" hx-indicator="#generate-loading">
                External Resources
            </button>
        </div>

        <div id="generate-loading" class="htmx-indicator">
            <div class="spinner"></div>
            <p class="loading-text">Generating...</p>
            <div class="progress-bar"><div class="progress-bar-fill"></div></div>
        </div>

        <div id="results-panel">
            <em>Your generated study content will appear here.</em>
        </div>

    </div>
</div>

<script src="/static/app.js"></script>

{% endblock %}